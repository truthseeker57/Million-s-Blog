/* =========================
  TOKENS
========================= */
:root {
  /* colors */
  --bg: #000;
  --fg: #d6ffd6;
  --dim: #9fd49f;
  --accent: #66ff99;
  --line: rgba(31, 31, 31, .9);
  --topbar-bg: rgba(17, 17, 17, .92);
  --panel-bg: rgba(17, 17, 17, .70);

  /* layout */
  --space-1: .25rem;
  --space-2: .5rem;
  --space-3: .75rem;
  --space-4: 1rem;
  --radius: 8px;
  --modal-inset: 6vw;
  --shadow-lg: 0 10px 40px rgba(0, 0, 0, .6);
}

/* =========================
  BASE
========================= */
* { box-sizing: border-box; }
html, body, #root { height: 100%; }
body {
  margin: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: "JetBrains Mono", ui-monospace, monospace;
  line-height: 1.6;
  font-weight: 300;
}
#root { position: relative; }
.bg { position: fixed; inset: 0; z-index: 0; pointer-events: none; }

/* Scrollbars (shared) */
html, * {
  scrollbar-width: thin;
  scrollbar-color: #1f1f1f #0c0c0c;
}
html::-webkit-scrollbar, *::-webkit-scrollbar { width: 12px; height: 12px; }
html::-webkit-scrollbar-track, *::-webkit-scrollbar-track { background: #0c0c0c; }
html::-webkit-scrollbar-thumb, *::-webkit-scrollbar-thumb {
  background: #1f1f1f; border: 3px solid var(--accent); border-radius: 10px;
}
*::-webkit-scrollbar-thumb:hover { background: #262626; }
*::-webkit-scrollbar-thumb:active { background: #2f2f2f; }
*::-webkit-scrollbar-track:vertical { border-left: 1px solid var(--line); }
*::-webkit-scrollbar-track:horizontal { border-top: 1px solid var(--line); }

/* =========================
  TOP BAR / NAV
========================= */
.topbar {
  position: sticky; top: 0; z-index: 2;
  display: flex; flex-direction: column; gap: var(--space-2);
  background: var(--topbar-bg);
  border-bottom: 1px solid var(--line);
  padding: var(--space-3) var(--space-4);
}
.brand { margin: 0; color: var(--accent); font-weight: 700; }
.toolbar { display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; }
.nav { display: flex; align-items: center; gap: .9rem; }
.nav .path { opacity: .9; }
.nav a {
  text-decoration: none; color: var(--fg);
  padding: .2rem .5rem; border: 1px solid transparent;
}
.nav a:hover, .nav a:focus {
  color: var(--accent); border-bottom: 1px solid var(--accent); transition: .3s;
}

/* Search */
.search { display: flex; align-items: center; gap: .4rem; margin-left: auto; }
.search-input {
  width: 280px; padding: .5rem .6rem; background: #101010;
  color: var(--fg); border: 1px solid var(--dim); outline: none;
}
.search-input:focus { border-color: var(--accent); }
.hint {
  border: 1px solid var(--line); padding: .1rem .35rem; border-radius: 4px;
  font-size: .8rem; color: var(--dim);
}

/* Responsive tweaks */
@media (max-width: 720px) { .search-input { width: 160px; } }

/* =========================
  LAYOUT
========================= */
.container { position: relative; z-index: 1; max-width: 1200px; margin: 0 auto; padding: var(--space-4); }
.layout { display: grid; grid-template-columns: 340px 1fr; gap: 24px; align-items: start; }
@media (max-width: 960px) {
  .layout { grid-template-columns: 1fr; }
  .featured-col { position: static; }
}

/* Featured left column */
.featured-col {
  position: sticky; top: 76px; align-self: start; z-index: 2;
  max-height: calc(100vh - 76px); overflow-y: auto; padding-right: 4px;
  scrollbar-width: none; -ms-overflow-style: none;
}
.featured-col::-webkit-scrollbar { display: none; }
.featured { margin: 0; position: relative; z-index: 2; }
.featured-title {
  margin: 4px 0 10px; color: #9effa9; font-weight: 700;
}
.featured-grid { display: grid; grid-template-columns: 1fr; gap: 2rem; }
.featured-card {
  text-align: left; padding: 14px; border: 1px dashed rgba(102,255,153,.5);
  background: rgba(0,0,0,.45); cursor: pointer; color: #c7ffcf; border-radius: 10px;
}
.featured-card:hover { border: 2px dashed rgba(102,255,153,.5); }
.featured-name { font-weight: 800; margin-bottom: 6px; font-size: .8rem; line-height: 1.2; }
.featured-meta, .featured-tags { font-size: .9rem; opacity: .9; }

/* =========================
  POSTS
========================= */
.post-toolbar { display: flex; gap: .75rem; margin-bottom: 1rem; }
.post-action {
  display: inline-flex; align-items: center; gap: .5rem;
  padding: .5rem 1rem; border: 1px dashed var(--accent);
  color: var(--accent); background: var(--panel-bg); cursor: pointer;
  font-weight: 600; transition: background .2s ease;
}
.post-action:hover { background: rgba(102,255,153,0.1); }
.post-block { margin: 1rem 0 2rem; padding: 1rem; border: 1px solid var(--line); background: var(--panel-bg); }
.post-actions { display: flex; justify-content: flex-end; margin-top: .75rem; }
.post-header { font-weight: 600; color: var(--accent); display: flex; align-items: center; gap: .5rem; flex-wrap: wrap; }
.post-excerpt { white-space: pre-line; margin: 1rem 0; }
.meta { font-size: .95rem; color: var(--dim); }
.divider { color: #404040; margin: .5rem 0; }

/* action buttons (read/edit/del) */
.post-action-btn {
  margin-left: .5rem; border: 3px solid var(--line);
  background: transparent; color: inherit; padding: .15rem .45rem; cursor: pointer;
  transition: .3s;
}
.read:hover { border-color: #2a2a2a; background: #fff; color: #000; }
.edit:hover { border-color: #2a2a2a; background: #3a48ff; color: #fff; }
.del:hover  { border-color: #2a2a2a; }

/* states */
.revealed { opacity: 1; }
.encrypted { opacity: .75; filter: saturate(140%); }
.empty { color: var(--dim); margin-top: 2rem; }

/* =========================
  MODALS (shared)
========================= */
.modal-backdrop {
  position: fixed; inset: 0; z-index: 3; background: rgba(0,0,0,.75); backdrop-filter: blur(2px);
}
.modal {
  position: fixed; inset: 4vh var(--modal-inset); z-index: 4;
  display: flex; flex-direction: column;
  border: 1px solid var(--line); background: var(--topbar-bg); box-shadow: var(--shadow-lg);
  animation: modalIn .12s ease-out;
}
.modal--flat {
  border: 1px solid var(--line); background: rgba(10,10,10,.98);
  width: min(980px, 96vw); max-height: 88vh; overflow: hidden;
}

/* Header / actions */
.modal__header {
  display: flex; align-items: center; justify-content: space-between; gap: var(--space-3);
  padding: var(--space-3) var(--space-4); border-bottom: 1px solid var(--line); background: rgba(12,12,12,.95);
}
.modal__title { margin: 0; color: var(--accent); font-weight: 700; letter-spacing: .02em; font-size: .95rem; }
.modal__actions { display: flex; gap: var(--space-2); }

/* Body */
.modal__body { display: flex; gap: 1rem; padding: 1rem; height: 100%; overflow: hidden; }
.modal__body--stack { display: flex; flex-direction: column; gap: .9rem; padding: 1rem; }

/* Mobile full-screen modal */
@media (max-width: 900px) {
  .modal { inset: 0; border-left: none; border-right: none; border-bottom: none; }
}

/* Read modal variant */
.modal[aria-labelledby="read-title"] {
  padding: 1rem 1.25rem; max-width: 900px; margin: 6vh auto; inset: auto var(--modal-inset);
}
@media (max-width: 900px) {
  .modal[aria-labelledby="read-title"] {
    inset: 0; margin: 0; max-width: none; border-left: none; border-right: none; border-bottom: none;
    padding: .85rem .95rem;
  }
}

/* Close */
.modal__close {
  position: absolute; top: .5rem; right: .5rem;
  width: 32px; height: 32px; display: grid; place-items: center;
  border: 1px solid var(--line); background: transparent; color: var(--dim); cursor: pointer;
}
.modal__close:hover { border-color: #2a2a2a; color: var(--fg); }

/* Animation */
@keyframes modalIn { from { transform: scale(.98); opacity: 0; } to { transform: scale(1); opacity: 1; } }

/* =========================
  READ VIEW
========================= */
.read-header { display: flex; align-items: center; justify-content: space-between; gap: .75rem; color: var(--accent); }
.read__title { margin: 0 0 .5rem; color: var(--accent); font-weight: 700; font-size: 1.1rem; }
.read__meta { display: flex; flex-wrap: wrap; gap: .35rem; margin: 0 0 1rem; color: var(--dim); }
.read-content {
  margin: 2rem 0 0; line-height: 1.75; color: var(--fg); background: var(--panel-bg);
  border: 1px solid var(--line); padding: 1rem; border-radius: var(--radius);
  max-height: calc(80vh - 120px); overflow: auto; white-space: pre-wrap; word-break: break-word; overflow-wrap: anywhere;
}

/* =========================
  FORMS / FIELDS
========================= */
.row { display: flex; gap: .8rem; }
.row--split > .field { flex: 1; }

.field label { display: block; margin-bottom: var(--space-1); color: var(--dim); font-size: .85rem; }
.input, .textarea {
  width: 100%; background: #0f0f0f; color: var(--fg);
  border: 1px solid var(--line); outline: none; padding: .55rem .6rem;
  font-family: "JetBrains Mono", ui-monospace, monospace;
}
.input:focus, .textarea:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent), transparent 75%);
  transition: .15s;
}
.input--bare { border: none; padding: 0 .25rem; background: transparent; }
.textarea { resize: none; min-height: 220px; max-height: 60vh; }

/* Buttons */
.btn {
  border: 1px solid var(--line); background: transparent; color: var(--fg);
  padding: .35rem .8rem; cursor: pointer; font-family: inherit;
}
.btn:hover { border-color: #2a2a2a; }
.btn--primary { border-color: var(--accent); color: #000; background: var(--accent); }
.btn--ghost { background: transparent; color: var(--dim); }
.btn--danger { border-color: #ff4d4d; color: #ff4d4d; }
.btn--danger:hover { background: #ff4d4d; color: #fff; }

.icon-btn {
  width: 32px; height: 32px; display: grid; place-items: center;
  border: 1px solid var(--line); background: transparent; color: var(--dim); cursor: pointer;
}
.icon-btn:hover { border-color: #2a2a2a; color: var(--fg); }

/* =========================
  TAGS INPUT
========================= */
.tags-input {
  display: flex; align-items: center; gap: .35rem; flex-wrap: wrap;
  min-height: 2.2rem; padding: .25rem .35rem; border: 1px dashed var(--line); background: #0c0c0c;
}
.chip {
  display: inline-flex; align-items: center; gap: .25rem;
  padding: .15rem .45rem; border: 1px solid var(--line); background: #111; color: var(--dim);
  font-size: .78rem; cursor: pointer;
}
.chip:hover { color: var(--fg); border-color: #2a2a2a; }

/* Legacy tag pills (if still used) */
.tags { display: flex; gap: .4rem; flex-wrap: wrap; margin-top: .35rem; }
.tag  { border: 1px solid var(--line); padding: .1rem .4rem; font-size: .78rem; color: var(--dim); background: #0e0e0e; }

/* =========================
  EDITOR (toolbar + RTE)
========================= */
.editor { border: 1px solid var(--line); background: #0c0c0c; }
.toolbar {
  display: flex; align-items: center; gap: .3rem;
  padding: .4rem .5rem; border-bottom: 1px solid var(--line); background: #0a0a0a;
}
.tbtn {
  font: inherit; border: 1px solid var(--line); background: #111; color: var(--fg);
  padding: .2rem .45rem; cursor: pointer; line-height: 1;
}
.tbtn:hover { background: #151515; border-color: #2a2a2a; }
.tsep { width: 1px; height: 20px; background: var(--line); margin: 0 .2rem; }
.toolbar__spacer { flex: 1; }
.counter { color: var(--dim); font-size: .78rem; }

/* textarea variant (if ever used again) */
.textarea--editor {
  resize: none; min-height: 220px; max-height: 60vh;
  padding: .75rem .8rem; line-height: 1.55; white-space: pre-wrap;
}

/* RTE */
.rte {
  min-height: 220px; max-height: 60vh; overflow: auto;
  padding: .8rem; line-height: 1.55; background: #0f0f0f; color: var(--fg);
  outline: none;
}
.rte:focus { box-shadow: inset 0 0 0 1px var(--accent); }
.rte:empty:before { content: attr(data-placeholder); color: var(--dim); }
.rte p { margin: .35rem 0; }
.rte h1, .rte h2, .rte h3 { color: #b2f5b2; margin: .6rem 0 .3rem; }
.rte h1 { font-size: 1.4rem; }
.rte h2 { font-size: 1.2rem; }
.rte h3 { font-size: 1.05rem; }
.rte blockquote { border-left: 2px solid var(--line); padding-left: .6rem; color: var(--dim); margin: .45rem 0; }
.rte ul, .rte ol { padding-left: 1.2rem; }
.rte code { background: #111; border: 1px solid var(--line); padding: .05rem .25rem; border-radius: 3px; }

/* =========================
  MISC MODALS (trash/drafts/confirm/notification)
========================= */
.trash-modal, .draft-modal {
  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
  width: min(760px, 92vw); max-height: 78vh; overflow: hidden;
  display: flex; flex-direction: column;
  background: #0f1419; color: #e6edf3;
  border: 1px solid #1f2a33; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,.45);
  z-index: 9991;
}
.trash-header, .draft-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 14px 16px; border-bottom: 1px solid #1f2a33;
}
.trash-title, .draft-title { margin: 0; font-size: 16px; font-weight: 700; }
.trash-tools, .draft-tools { display: flex; align-items: center; gap: 8px; }
.trash-search, .draft-search {
  height: 32px; padding: 0 10px; border-radius: 8px; border: 1px solid #243444;
  background: #0c1116; color: #d7e3ec; width: 220px; outline: none;
}
.trash-body, .draft-body { padding: 6px 0 10px; overflow: auto; }
.trash-empty, .draft-empty { padding: 24px 18px; color: #9fb1bd; }
.trash-list, .draft-list { list-style: none; margin: 0; padding: 6px 6px 12px; }

.trashed-item, .draft-item {
  display: grid; grid-template-columns: 1fr auto; gap: 12px 16px; align-items: center;
  padding: 12px; border-bottom: 1px dashed #1f2a33;
}
.trashed-item__title, .drafted-item__title {
  font-size: 14px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.trashed-item__meta, .drafted-item__meta {
  margin-top: 6px; display: flex; gap: 8px; font-size: 12px; color: #99a7b3;
}
.trashed-item__date, .trashed-item__time, .drafted-item__date, .drafted-item__time {
  padding: 2px 6px; border: 1px solid #1f2a33; border-radius: 999px; background: #0c1116;
}
.trashed-item__tags, .drafted-item__tags { margin-top: 8px; display: flex; gap: 6px; flex-wrap: wrap; }
.trashed-tag, .drafted-tag {
  padding: 2px 8px; border-radius: 999px; background: #13202a; border: 1px solid #1e3240;
  color: #9fd3ff; font-weight: 600; letter-spacing: .3px;
}
.trashed-item__actions, .drafted-item__actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 8px; }
.trash-count, .draft-count {
  display: inline-flex; align-items: center; justify-content: center;
  margin-left: .5rem; min-width: 1.4em; height: 1.4em; padding: 0 .5em;
  border-radius: 999px; background: var(--accent); color: var(--bg);
  font-weight: 700; font-size: .75rem; line-height: 1; font-variant-numeric: tabular-nums;
}
.draft-clear { margin: 1rem; }

.confirm-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.55); z-index: 10000; }
.confirm-modal {
  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
  width: min(420px, 92vw); background: #111; color: #eee;
  border: 1px solid #222; border-radius: 12px; padding: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.4);
  z-index: 10001;
}
.confirm-title { margin: 0 0 8px; font-size: 18px; font-weight: 800; }
.confirm-text  { margin: 0 0 14px; opacity: .9; }
.confirm-actions { display: flex; justify-content: flex-end; gap: 8px; }
.btn-danger { border-color: #5a1f1f; background: #2a0f0f; color: #ffc7c7; }

.notification {
  position: fixed; top: 6.5rem; right: 1.25rem; z-index: 9999;
  padding: 1rem 1.5rem; background: var(--topbar-bg);
  border: 2px solid var(--accent); color: var(--fg);
  font-family: "JetBrains Mono", ui-monospace; font-size: .9rem; border-radius: 8px;
  box-shadow: 0 0 12px rgba(102,255,153,.25);
  opacity: 0; animation: fadeSlideIn .3s ease-out forwards, fadeOut .3s ease-in 3.9s forwards;
}
@keyframes fadeSlideIn { from { transform: translateX(120%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
@keyframes fadeOut      { to   { opacity: 0; transform: translateX(120%); } }

/* ---------- MOBILE LAYOUT FIXES ---------- */
@media (max-width: 960px) {
  /* 1) make it a simple vertical flow */
  .layout {
    display: block;              /* avoid grid weirdness on small screens */
  }

  /* 2) featured column: no sticky, no stacking, no scroll box */
  .featured-col {
    position: static !important;
    top: auto !important;
    max-height: none !important;
    overflow: visible !important;
    padding-right: 0 !important;
    z-index: auto !important;
  }

  /* 3) kill the global z-index on featured so it doesn't overlay posts */
  .featured,
  .featured * {
    position: static !important;
    z-index: auto !important;
  }

  /* 4) center the regular posts/toolbars on mobile */
  .post-toolbar,
  .post-block,
  .read-content {
    max-width: 820px;
    margin-left: auto;
    margin-right: auto;
  }

  /* optional: tighten horizontal padding a bit */
  .container {
    padding-left: 1rem;
    padding-right: 1rem;
  }
}
